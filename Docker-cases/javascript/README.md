# Node.js Dockerfile サンプル

このディレクトリには、Node.js アプリケーションのための Dockerfile が含まれています。

## 特徴

- マルチステージビルドを使用して軽量なイメージを生成
- Alpine Linux ベースのイメージを使用
- 本番環境用の依存関係のみをインストール
- セキュリティを考慮した非 root ユーザーでの実行
- 最適化されたレイヤーキャッシュ

## 使用方法

### イメージのビルド

```bash
docker build -t nodejs-app .
```

### コンテナの実行

```bash
docker run -p 3000:3000 nodejs-app
```

## Dockerfile の説明

この Dockerfile は以下の 2 つのステージで構成されています：

1. **ビルドステージ**

   - node:18-alpine をベースイメージとして使用
   - 依存関係のインストールとアプリケーションのビルドを実行
   - 開発用の依存関係も含めてビルド

2. **実行ステージ**
   - node:18-alpine をベースイメージとして使用
   - 本番環境用の依存関係のみをインストール
   - ビルド済みファイルのみをコピー
   - 非 root ユーザーでアプリケーションを実行

## 注意事項

- アプリケーションは 3000 ポートでリッスンすることを想定しています
- 必要に応じて`EXPOSE`と`CMD`を調整してください
- 本番環境では、セキュリティを考慮して非 root ユーザーでの実行を推奨します
- `package.json`に`build`スクリプトが定義されている場合、ビルドステージで実行されます
